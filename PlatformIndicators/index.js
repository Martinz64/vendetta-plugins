(function(R,f,u,b,d,n,i,v,E,e,V){"use strict";const{View:N,Text:ee,Image:K,Pressable:re}=i.ReactNative;u.findByName("Svg",!1).default,u.findByName("Svg",!1).Path,v.getAssetIDByName("ic_monitor_24px"),v.getAssetIDByName("ic_globe_24px"),v.getAssetIDByName("ic_mobile_device"),v.getAssetIDByName("ic_monitor_24px");const k={desktop:{url:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEgAAABICAMAAABiM0N1AAAAVFBMVEUAAACvv7+3u7+5u7+2ub+4u726vL65u765vL65vMG5u723ub23v7+3t7+6vL+4ur+6u765u764vL+4ur23t7+7vb+3ur25ur64ur+7u766ur6vr7/+1nXbAAAAHHRSTlMAEEB/UHDv/99fgIAgQJ+f7++fnyB/YN9vTz8QSaZf3QAAAI1JREFUeAHt1tUBwkAURNEXHZzg1n+d2Fc8u4OTOQXcyKqJ3ARh5C22qiQFYTC0khFIYyuYgDYthGagzQuhDLRFIYS7yBPuakLmSaF2CimkkEIKKfT8I5un0MdCT7v6LUFbFUIhaGsr2IAUWcl2B0K2t6pDVKttGR5P3BJvpxCnfdTMHVo9NaRQ1MpKRC5jHSw3VFQzIwAAAABJRU5ErkJggg==",path:"PlatformIndicators/Desktop.png"},web:{url:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEgAAABICAQAAAD/5HvMAAADgklEQVR42u3a32vVdRzH8VdOv2NzGzM7bkp0E9F9RQSbOmK6groQpeugOzXJfnCW3YwgC4IyHCldrBmFELtQRxfK2MHp1sjVZRfBMSJFYu6cMUnOOZPz9Gb45uyc79fv5/tDvDiPv+DJh/fn8+HL56umpqbHFZsZ4hjjzJOnQJkyBfLMM87H7GWzHh16OcoVKgQpM8N79Cht7GaSVcJa5QK7lBZe5SpRzDCgpLGdH6gS3SRPKzm8xTJxFTmgJNDKtyRllFbFQxfTRLVCvSk6FR3b+J3onuRTlllvgUzk1YmVsyJJdPMN1bqkzmizM00cc1rDIP9SawpPrjhFPAf1AN1cotZJ940ezwKb1q33BLX2Kzx2sBwzZ7vWoYXvAVOkV2FxlqjuMMtBNqkBNpIDzI/h7ywnTsfIP5gquxUGV3EiB7zMPcxlPRwDOJITTgNmpx6GyZSDnqKAOa9g9LKKIzniA0yFbQrC+5B6UDf/Y44oCFdwdUPOGMfkgr8kyrg6Lmf0YUq0yw9DuLnBcTw5YwNFzB754RhmkYaUCH7BDMsPZzDDZFMM+gQzJj/8inlTYiS1oNcws/LD35jnJUtKPOgFzHX5YQmzdmCRTSXoGcyi/FDGtEqWlHhQG6YULsjTA4zg5iZf4CkAXrig25gtUowk+FwB2IpZDDfUz8pEWiUF4DnM9XDbfkiKl6QAvB5u248H38KMJBZ0FDMW7uo4qwbIJhQ0gcnKD3sxN3lCirNKgZfrf5hB+aGdEuYVNUQ2dtAuTIk2+WMG87V8MBIzaBQzrdDDVqBDPuIE0cUy5rCC0MMq5lAqQR9hKmRcPoNu0ZF0EN0sYs7JBAyc+UwNsUJYd7nGO2zUGr4CTL9MqMGu8KIaYB43C2yVJPq4h8kpDAaoYv6kS3U4jKvfaGELeUyVfoXDT4C5wAatg8cfuHqbS4A54/K8UgTMd/WnNjuckyqAKdCj8DhArdO0NFilQ8xxhyiq7JMbRqk1GXAEuDshV3hMUesvXkoo6CKe3NHJArUqfEln7KBrdCgaMnVJcIsPa6OcczKKjk6mqFfkFH20RAi6SIfiweMkjS0xwTBvEFaVE3hKAvspEleBfUoOvTGfOH+mJ40X6ctEkaNfaWEn56kQVoVz9CltZDhCjhJBSuR4l4weHdrZwzBjzJFniTJlbpNnljGyDNLW/BmlqelxdR++AoGbDB4jjAAAAABJRU5ErkJggg==",path:"PlatformIndicators/Web.png"},mobile:{url:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGAAAABgCAMAAADVRocKAAAAXVBMVEUAAAAwMDgwMDUwMDUuMDYwMDYvMTcvMTYvMTYwMDYwMDUvMTYwMjUvMTUvMjYvMTUuMDUuMDQvMDUtMTUwMDgvMDUwMDAtMDYuMDYwMDAtMDUvMDYuMDUtMDcpMTo5aAq8AAAAH3RSTlMAIGBvf1C//89fMN9g75+/j3+fP0C/IFBfMGDPb08fcZ9WCgAAAMNJREFUeAHt2YWNxQAMg2EX/fiVud1/zBuhSaRjfwv8UsQx5J9L0iw/VySIyUoaXa7wu93pcE/g9KDTFS4F+amF5Em3ZwK7FwPeMEsYcoNVxZAaViX5uTd6MuQJKwY5A01u9goFWph1fyKggAIKKKCAAgoooIACCiiggAIKKKCAAgoooIACn/l9d/t3gU/fcEqG9LDKGVLB6saQAZ97owZ2w5NuzwEOKd1G4FMLE5wG36Y/w29ZadRviBn2/Nw2HfjTPgD3/UVA1TCAGgAAAABJRU5ErkJggg==",path:"PlatformIndicators/Mobile.png"},embedded:{url:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEgAAABICAMAAABiM0N1AAAAk1BMVEUAAAC3u7+4ur+5vL+5u765u7+6vL+2ub+3v7+6u7+5vL66v7+6vL65u761ur+4u765vL+3t7+6u765u7+9vb23t7+7vb+6u766ur+5ur6/v7+vv7+9vcW1tb+5u727u763ur25vL+6vL+3ub24ur+5u7+4vL+5ur66ur64ur25vL+6u764ur24u722uby5u76vr7/eehxsAAAAMXRSTlMAQJ/f/8+fUCC/3zDv7zC/UEDvfx8gf88w3xAQHzCAT2Bfb4Bvj5/PP6+vv59wUM8QEONx+AAAAWZJREFUeAHt1dWa6zAMBOA5PSqzs2Vmhvd/uWWcVFHqr5f+r+3JRqtJ8UhBEAT/Mv8lpWwuD02hKHcpFXBTuSJ3qtZwQ0HPUVULiCuJhzpiGuKlCZaTL3gnxEVPaLWdkAxYJznIdfGmy0k9MEkOivChLQSkbwS18KElZEBBLSMIX4QMuRxaEJ0vCBndCkJMbEZjIRO6MTWCqjWlRjO6MTeCpLoooDWuCFvSjcgK0pYzohsrM0hZzhXdWJtBynJyR4rGv19dzrp3EC3nhoJKZpCynNxalzqIlrPKU7WDlOXUym8H0XIOufy+htxZX9tHBU24/L5mXH5fSy6/r4jL/8sOidYJv2x7fu0k84SgIn/Qmb50dT2oB6YXk+tf4hElWuuPdeaIlCFx/fkLeM+Q1Ferw3RQZ9SmP8jQlR9H/NZ3tKmG08+sW/SMnrxzZ6Qy/TrfBWkdL+Lq0RUptaYHJyU+HwRB4O0FjTMnvIkvoBQAAAAASUVORK5CYII=",path:"PlatformIndicators/Console.png"}};function x(t){const{platform:p,color:h}=t,l=t.iconSize??16;return React.createElement(N,null,React.createElement(K,{style:{height:l,width:l,tintColor:h},source:{uri:k[p].url,width:l,height:l,path:k[p].path,allowTheming:!0}}))}const J={online:i.chroma(E.rawColors.GREEN_360).hex(),dnd:i.chroma(E.rawColors.RED_400).hex(),idle:i.chroma(E.rawColors.YELLOW_300).hex(),offline:i.chroma(E.rawColors.PRIMARY_400).hex()},z={online:"#23a55a",dnd:"#f23f43",idle:"#f0b232",offline:"#80848e"};function P(t){return arguments.length>1&&arguments[1]!==void 0&&arguments[1]?z[t]:J[t]}const G=u.findByStoreName("PresenceStore"),H=u.findByStoreName("SessionsStore"),Q=u.findByStoreName("UserStore");let B,I=0,C,U;function Y(){return C||(C=setTimeout(function(){I=0,C=null},5e3)),(!B||I==0)&&(B=G.getState()),I=(I+1)%20,B}function O(t){let p;return U||(U=Q.getCurrentUser()?.id),t==U?p=Object.values(H.getSessions()).reduce(function(h,l){return l.clientInfo.client!=="unknown"&&(h[l.clientInfo.client]=l.status),h},{}):p=Y()?.clientStatuses[t],p}function g(t){V.useProxy(e.storage);const p=t.userId,h=t.size??16,l=O(p);return n.createElement(n.Fragment,null,Object.keys(l??{}).map(function(M){return n.createElement(x,{platform:M,color:P(l[M],e.storage.fallbackColors),iconSize:h})}))}const{View:j,ScrollView:Z}=i.ReactNative;function q(){return V.useProxy(e.storage),i.React.createElement(Z,null,i.React.createElement(j,null,i.React.createElement(b.Forms.FormSwitchRow,{label:"Show icons on the dm top bar",value:e.storage.dmTopBar??!0,onValueChange:function(t){return e.storage.dmTopBar=t},note:""}),i.React.createElement(b.Forms.FormSwitchRow,{label:"Show icons on the users and DMs list",value:e.storage.userList??!0,onValueChange:function(t){return e.storage.userList=t},note:""}),i.React.createElement(b.Forms.FormSwitchRow,{label:"Show icons on user profiles",value:e.storage.profileUsername??!0,onValueChange:function(t){return e.storage.profileUsername=t},note:""}),i.React.createElement(b.Forms.FormSwitchRow,{label:"Hide mobile status from the normal indicator",value:e.storage.removeDefaultMobile??!0,onValueChange:function(t){return e.storage.removeDefaultMobile=t},note:""}),i.React.createElement(b.Forms.FormSwitchRow,{label:"Theme compatibility mode",value:e.storage.fallbackColors??!1,onValueChange:function(t){return e.storage.fallbackColors=t},note:""}),i.React.createElement(b.Forms.FormSwitchRow,{label:"Old user list icon style",value:e.storage.oldUserListIcons??!1,onValueChange:function(t){return e.storage.oldUserListIcons=t},note:"Moves status indicators to the right"})))}const T=function(t){let{children:p}=t;const[h,l]=n.useState(0);return n.useEffect(function(){const M=function(){l(function(w){return w+1})};return i.FluxDispatcher.subscribe("PRESENCE_UPDATES",M),function(){i.FluxDispatcher.unsubscribe("PRESENCE_UPDATES",M)}},[]),n.Children.map(p,function(M,w){return n.cloneElement(M,{key:`${w}-${h}`})})},{Text:te,View:D}=b.General;let A=[];var W={onLoad:function(){e.storage.dmTopBar??=!0,e.storage.userList??=!0,e.storage.profileUsername??=!0,e.storage.removeDefaultMobile??=!0,e.storage.fallbackColors??=!1,e.storage.oldUserListIcons??=!1,A.push(f.patcher.after("render",D,function(o,r){}));const t=u.findByDisplayName("Pressable",!1);A.push(f.patcher.before("render",t.default.type,function(o){if(!o||!o[0])return;const[r]=o;if(r){if(e.storage.userList&&r?.children?.props?.children?.props?.children&&r.children.props.children.props.children[1]?.type?.type?.name=="ChannelUnreadBadge"){const s=r.children.props.children,a=d.findInReactTree(s,function(c){return c?.user});if(a?.user&&!d.findInReactTree(r,function(c){return c?.key=="TabsV2-DM-List"})){const c=d.findInReactTree(r,function(m){return m?.props?.variant=="text-md/semibold"||m?.props?.variant=="redesign/channel-title/semibold"});c&&(c.props.children=[c.props.children,n.createElement(D,{key:"TabsV2-DM-List",style:{flexDirection:"row",justifyContent:"center",alignContent:"flex-start"}},n.createElement(T,null,n.createElement(g,{userId:a.user.id})))])}}if(r.accessibilityRole=="button"){if(!e.storage.userList)return;if(r?.children?.props?.children?.props?.children&&r?.children?.props?.children?.props?.children[0]?.type?.type?.name=="GuildContainerIndicator"){const s=r?.children?.props?.children?.props?.children[1]?.props?.children[0]?.props?.children?.props?.user?.id;if(r?.children?.props?.children?.props?.children[1]?.props?.children[0]?.props?.children?.props?.guildId)return;if(s){const a=r?.children?.props?.children?.props?.children[2]?.props?.children[0];if(a){const c=a.props.children[0].props.children;d.findInReactTree(c,function(m){return m.key=="DMTabsV2DMList-v2"})||c.push(n.createElement(T,{key:"DMTabsV2DMList-v2"},n.createElement(g,{userId:s})))}}}}}})),u.findByStoreName("PresenceStore"),A.push(f.patcher.after("default",u.findByName("ChannelHeader",!1),function(o,r){e.storage.dmTopBar&&r.type?.type?.name=="PrivateChannelHeader"&&f.patcher.after("type",r.type,function(s,a){if(!a.props?.children?.props?.children)return;const c=d.findInReactTree(a,function(y){return y.props?.user?.id})?.props?.user?.id;if(!c)return;const m=a.props?.children;if(!d.findInReactTree(a,function(y){return y.key=="DMTabsV2Header"})&&m.props?.children?.props?.children[1])if(typeof m.props?.children?.props?.children[1]?.type=="function"){const y=m.props?.children?.props?.children[1],S=f.patcher.after("type",y,function(ne,F){S(),d.findInReactTree(F,function(_){return _.key=="DMTabsV2Header-v2"})||F.props.children[0].props.children.push(n.createElement(T,{key:"DMTabsV2Header-v2"},n.createElement(g,{userId:c})))})}else{const y=v.getAssetIDByName("arrow-right");d.findInReactTree(m,function(S){return S.props?.children[1]?.props?.source==y}).props?.children?.push(n.createElement(D,{key:"DMTabsV2Header",style:{flexDirection:"row",justifyContent:"center",alignContent:"flex-start"}},n.createElement(D,{key:"DMTabsV2HeaderIcons",style:{flexDirection:"row"}})))}const L=d.findInReactTree(a,function(y){return y.key=="DMTabsV2HeaderIcons"});L&&(L.props.children=n.createElement(g,{userId:c}))})}));const p=u.findByName("DefaultName",!1);A.push(f.patcher.after("default",p,function(o,r){const s=o[0]?.user;s!==void 0&&r&&s.id&&e.storage.profileUsername&&r.props?.children[0]?.props?.children?.push(n.createElement(g,{userId:s.id}))}));const h=u.findByName("DisplayName",!1);A.push(f.patcher.after("default",h,function(o,r){const s=o[0]?.user;s!==void 0&&r&&s.id&&e.storage.profileUsername&&r.props?.children?.props?.children[0]?.props?.children?.push(n.createElement(g,{userId:s.id}))}));const l=u.findByName("Status",!1);A.push(f.patcher.before("default",l,function(o){o&&o[0]&&e.storage.removeDefaultMobile&&(o[0].isMobileOnline=!1)}));const M=u.findByProps("GuildMemberRow");M?.GuildMemberRow&&A.push(f.patcher.after("type",M.GuildMemberRow,function(o,r){let[{user:s}]=o;!e.storage.userList||e.storage.oldUserListIcons||d.findInReactTree(r,function(a){return a.key=="GuildMemberRowStatusIconsView"})||d.findInReactTree(r,function(a){return a.props.style.flexDirection==="row"}).props.children.splice(2,0,n.createElement(D,{key:"GuildMemberRowStatusIconsView",style:{flexDirection:"row"}},n.createElement(g,{userId:s.id})))}));let w=!1;const X=function(o,r){let[{user:s}]=o;e.storage.userList&&(d.findInReactTree(r?.props?.label,function(a){return a.key=="TabsV2MemberListStatusIconsView"})||(r.props.label=n.createElement(D,{style:{justifyContent:e.storage.oldUserListIcons?"space-between":"flex-start",flexDirection:"row",alignItems:"center"},key:"TabsV2MemberListStatusIconsView"},r.props.label,n.createElement(D,{key:"TabsV2MemberListStatusIconsView",style:{flexDirection:"row"}},n.createElement(g,{userId:s.id}))),w||(A.push(f.patcher.before("type",r.props.icon.type,function(a){e.storage.removeDefaultMobile&&(a[0].isMobileOnline=!1)})),w=!0)))};u.findByTypeNameAll("UserRow").forEach(function(o){return A.push(f.patcher.after("type",o,X))});const $=u.findByTypeName("MessagesItemChannelContent");A.push(f.patcher.after("type",$,function(o,r){const s=o[0]?.channel;if(s?.recipients?.length==1){const a=s.recipients[0];d.findInReactTree(r,function(c){return c.props.children[0].props.variant=="redesign/channel-title/semibold"}).props.children.push(n.createElement(D,{key:"TabsV2RedesignDMListIcons",style:{flexDirection:"row"}},n.createElement(g,{userId:a})))}}))},onUnload:function(){A.forEach(function(t){return t()})},settings:function(){return n.createElement(q,null)}};return R.default=W,Object.defineProperty(R,"__esModule",{value:!0}),R})({},vendetta,vendetta.metro,vendetta.ui.components,vendetta.utils,window.React,vendetta.metro.common,vendetta.ui.assets,vendetta.ui,vendetta.plugin,vendetta.storage);
