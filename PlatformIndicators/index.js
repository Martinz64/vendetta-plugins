(function(I,p,l,b,d,n,i,w,E,e,S){"use strict";const{View:N,Text:ee,Image:K,Pressable:te}=i.ReactNative;l.findByName("Svg",!1).default,l.findByName("Svg",!1).Path,w.getAssetIDByName("ic_monitor_24px"),w.getAssetIDByName("ic_globe_24px"),w.getAssetIDByName("ic_mobile_device"),w.getAssetIDByName("ic_monitor_24px");const V={desktop:{url:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEgAAABICAMAAABiM0N1AAAAVFBMVEUAAACvv7+3u7+5u7+2ub+4u726vL65u765vL65vMG5u723ub23v7+3t7+6vL+4ur+6u765u764vL+4ur23t7+7vb+3ur25ur64ur+7u766ur6vr7/+1nXbAAAAHHRSTlMAEEB/UHDv/99fgIAgQJ+f7++fnyB/YN9vTz8QSaZf3QAAAI1JREFUeAHt1tUBwkAURNEXHZzg1n+d2Fc8u4OTOQXcyKqJ3ARh5C22qiQFYTC0khFIYyuYgDYthGagzQuhDLRFIYS7yBPuakLmSaF2CimkkEIKKfT8I5un0MdCT7v6LUFbFUIhaGsr2IAUWcl2B0K2t6pDVKttGR5P3BJvpxCnfdTMHVo9NaRQ1MpKRC5jHSw3VFQzIwAAAABJRU5ErkJggg==",path:"PlatformIndicators/Desktop.png"},web:{url:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEgAAABICAQAAAD/5HvMAAADgklEQVR42u3a32vVdRzH8VdOv2NzGzM7bkp0E9F9RQSbOmK6groQpeugOzXJfnCW3YwgC4IyHCldrBmFELtQRxfK2MHp1sjVZRfBMSJFYu6cMUnOOZPz9Gb45uyc79fv5/tDvDiPv+DJh/fn8+HL56umpqbHFZsZ4hjjzJOnQJkyBfLMM87H7GWzHh16OcoVKgQpM8N79Cht7GaSVcJa5QK7lBZe5SpRzDCgpLGdH6gS3SRPKzm8xTJxFTmgJNDKtyRllFbFQxfTRLVCvSk6FR3b+J3onuRTlllvgUzk1YmVsyJJdPMN1bqkzmizM00cc1rDIP9SawpPrjhFPAf1AN1cotZJ940ezwKb1q33BLX2Kzx2sBwzZ7vWoYXvAVOkV2FxlqjuMMtBNqkBNpIDzI/h7ywnTsfIP5gquxUGV3EiB7zMPcxlPRwDOJITTgNmpx6GyZSDnqKAOa9g9LKKIzniA0yFbQrC+5B6UDf/Y44oCFdwdUPOGMfkgr8kyrg6Lmf0YUq0yw9DuLnBcTw5YwNFzB754RhmkYaUCH7BDMsPZzDDZFMM+gQzJj/8inlTYiS1oNcws/LD35jnJUtKPOgFzHX5YQmzdmCRTSXoGcyi/FDGtEqWlHhQG6YULsjTA4zg5iZf4CkAXrig25gtUowk+FwB2IpZDDfUz8pEWiUF4DnM9XDbfkiKl6QAvB5u248H38KMJBZ0FDMW7uo4qwbIJhQ0gcnKD3sxN3lCirNKgZfrf5hB+aGdEuYVNUQ2dtAuTIk2+WMG87V8MBIzaBQzrdDDVqBDPuIE0cUy5rCC0MMq5lAqQR9hKmRcPoNu0ZF0EN0sYs7JBAyc+UwNsUJYd7nGO2zUGr4CTL9MqMGu8KIaYB43C2yVJPq4h8kpDAaoYv6kS3U4jKvfaGELeUyVfoXDT4C5wAatg8cfuHqbS4A54/K8UgTMd/WnNjuckyqAKdCj8DhArdO0NFilQ8xxhyiq7JMbRqk1GXAEuDshV3hMUesvXkoo6CKe3NHJArUqfEln7KBrdCgaMnVJcIsPa6OcczKKjk6mqFfkFH20RAi6SIfiweMkjS0xwTBvEFaVE3hKAvspEleBfUoOvTGfOH+mJ40X6ctEkaNfaWEn56kQVoVz9CltZDhCjhJBSuR4l4weHdrZwzBjzJFniTJlbpNnljGyDNLW/BmlqelxdR++AoGbDB4jjAAAAABJRU5ErkJggg==",path:"PlatformIndicators/Web.png"},mobile:{url:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGAAAABgCAMAAADVRocKAAAAXVBMVEUAAAAwMDgwMDUwMDUuMDYwMDYvMTcvMTYvMTYwMDYwMDUvMTYwMjUvMTUvMjYvMTUuMDUuMDQvMDUtMTUwMDgvMDUwMDAtMDYuMDYwMDAtMDUvMDYuMDUtMDcpMTo5aAq8AAAAH3RSTlMAIGBvf1C//89fMN9g75+/j3+fP0C/IFBfMGDPb08fcZ9WCgAAAMNJREFUeAHt2YWNxQAMg2EX/fiVud1/zBuhSaRjfwv8UsQx5J9L0iw/VySIyUoaXa7wu93pcE/g9KDTFS4F+amF5Em3ZwK7FwPeMEsYcoNVxZAaViX5uTd6MuQJKwY5A01u9goFWph1fyKggAIKKKCAAgoooIACCiiggAIKKKCAAgoooIACn/l9d/t3gU/fcEqG9LDKGVLB6saQAZ97owZ2w5NuzwEOKd1G4FMLE5wG36Y/w29ZadRviBn2/Nw2HfjTPgD3/UVA1TCAGgAAAABJRU5ErkJggg==",path:"PlatformIndicators/Mobile.png"},embedded:{url:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEgAAABICAMAAABiM0N1AAAAk1BMVEUAAAC3u7+4ur+5vL+5u765u7+6vL+2ub+3v7+6u7+5vL66v7+6vL65u761ur+4u765vL+3t7+6u765u7+9vb23t7+7vb+6u766ur+5ur6/v7+vv7+9vcW1tb+5u727u763ur25vL+6vL+3ub24ur+5u7+4vL+5ur66ur64ur25vL+6u764ur24u722uby5u76vr7/eehxsAAAAMXRSTlMAQJ/f/8+fUCC/3zDv7zC/UEDvfx8gf88w3xAQHzCAT2Bfb4Bvj5/PP6+vv59wUM8QEONx+AAAAWZJREFUeAHt1dWa6zAMBOA5PSqzs2Vmhvd/uWWcVFHqr5f+r+3JRqtJ8UhBEAT/Mv8lpWwuD02hKHcpFXBTuSJ3qtZwQ0HPUVULiCuJhzpiGuKlCZaTL3gnxEVPaLWdkAxYJznIdfGmy0k9MEkOivChLQSkbwS18KElZEBBLSMIX4QMuRxaEJ0vCBndCkJMbEZjIRO6MTWCqjWlRjO6MTeCpLoooDWuCFvSjcgK0pYzohsrM0hZzhXdWJtBynJyR4rGv19dzrp3EC3nhoJKZpCynNxalzqIlrPKU7WDlOXUym8H0XIOufy+htxZX9tHBU24/L5mXH5fSy6/r4jL/8sOidYJv2x7fu0k84SgIn/Qmb50dT2oB6YXk+tf4hElWuuPdeaIlCFx/fkLeM+Q1Ferw3RQZ9SmP8jQlR9H/NZ3tKmG08+sW/SMnrxzZ6Qy/TrfBWkdL+Lq0RUptaYHJyU+HwRB4O0FjTMnvIkvoBQAAAAASUVORK5CYII=",path:"PlatformIndicators/Console.png"}};function x(r){const{platform:u,color:h}=r,s=r.iconSize??16;return React.createElement(N,null,React.createElement(K,{style:{height:s,width:s,tintColor:h},source:{uri:V[u].url,width:s,height:s,path:V[u].path,allowIconTheming:!0}}))}const J={online:i.chroma(E.rawColors.GREEN_360).hex(),dnd:i.chroma(E.rawColors.RED_400).hex(),idle:i.chroma(E.rawColors.YELLOW_300).hex(),offline:i.chroma(E.rawColors.PRIMARY_400).hex()},z={online:"#23a55a",dnd:"#f23f43",idle:"#f0b232",offline:"#80848e"};function P(r,u=!1){return u?z[r]:J[r]}const G=l.findByStoreName("PresenceStore"),H=l.findByStoreName("SessionsStore"),Q=l.findByStoreName("UserStore");let R,v=0,B,C;function Y(){return B||(B=setTimeout(function(){v=0,B=null},5e3)),(!R||v==0)&&(R=G.getState()),v=(v+1)%20,R}function O(r){let u;return C||(C=Q.getCurrentUser()?.id),r==C?u=Object.values(H.getSessions()).reduce(function(h,s){return s.clientInfo.client!=="unknown"&&(h[s.clientInfo.client]=s.status),h},{}):u=Y()?.clientStatuses[r],u}function M(r){S.useProxy(e.storage);const u=r.userId,h=r.size??16,s=O(u);return n.createElement(n.Fragment,null,Object.keys(s??{}).map(function(g){return n.createElement(x,{platform:g,color:P(s[g],e.storage.fallbackColors),iconSize:h})}))}const{View:j,ScrollView:Z}=i.ReactNative;function q(){return S.useProxy(e.storage),i.React.createElement(Z,null,i.React.createElement(j,null,i.React.createElement(b.Forms.FormSwitchRow,{label:"Show icons on the dm top bar",value:e.storage.dmTopBar??!0,onValueChange:function(r){return e.storage.dmTopBar=r},note:""}),i.React.createElement(b.Forms.FormSwitchRow,{label:"Show icons on the users and DMs list",value:e.storage.userList??!0,onValueChange:function(r){return e.storage.userList=r},note:""}),i.React.createElement(b.Forms.FormSwitchRow,{label:"Show icons on user profiles",value:e.storage.profileUsername??!0,onValueChange:function(r){return e.storage.profileUsername=r},note:""}),i.React.createElement(b.Forms.FormSwitchRow,{label:"Hide mobile status from the normal indicator",value:e.storage.removeDefaultMobile??!0,onValueChange:function(r){return e.storage.removeDefaultMobile=r},note:""}),i.React.createElement(b.Forms.FormSwitchRow,{label:"Theme compatibility mode",value:e.storage.fallbackColors??!1,onValueChange:function(r){return e.storage.fallbackColors=r},note:""}),i.React.createElement(b.Forms.FormSwitchRow,{label:"Old user list icon style",value:e.storage.oldUserListIcons??!1,onValueChange:function(r){return e.storage.oldUserListIcons=r},note:"Moves status indicators to the right"})))}const U=function({children:r}){const[u,h]=n.useState(0);return n.useEffect(function(){const s=function(){h(function(g){return g+1})};return i.FluxDispatcher.subscribe("PRESENCE_UPDATES",s),function(){i.FluxDispatcher.unsubscribe("PRESENCE_UPDATES",s)}},[]),n.Children.map(r,function(s,g){return n.cloneElement(s,{key:`${g}-${u}`})})},{Text:re,View:D}=b.General;let A=[];var W={onLoad:function(){e.storage.dmTopBar??=!0,e.storage.userList??=!0,e.storage.profileUsername??=!0,e.storage.removeDefaultMobile??=!0,e.storage.fallbackColors??=!1,e.storage.oldUserListIcons??=!1,A.push(p.patcher.after("render",D,function(a,t){}));const r=l.findByDisplayName("Pressable",!1);A.push(p.patcher.before("render",r.default.type,function(a){if(!a||!a[0])return;const[t]=a;if(t){if(e.storage.userList&&t?.children?.props?.children?.props?.children&&t.children.props.children.props.children[1]?.type?.type?.name=="ChannelUnreadBadge"){const o=t.children.props.children,f=d.findInReactTree(o,function(c){return c?.user});if(f?.user&&!d.findInReactTree(t,function(c){return c?.key=="TabsV2-DM-List"})){const c=d.findInReactTree(t,function(m){return m?.props?.variant=="text-md/semibold"||m?.props?.variant=="redesign/channel-title/semibold"});c&&(c.props.children=[c.props.children,n.createElement(D,{key:"TabsV2-DM-List",style:{flexDirection:"row",justifyContent:"center",alignContent:"flex-start"}},n.createElement(U,null,n.createElement(M,{userId:f.user.id})))])}}if(t.accessibilityRole=="button"){if(!e.storage.userList)return;if(t?.children?.props?.children?.props?.children&&t?.children?.props?.children?.props?.children[0]?.type?.type?.name=="GuildContainerIndicator"){const o=t?.children?.props?.children?.props?.children[1]?.props?.children[0]?.props?.children?.props?.user?.id;if(t?.children?.props?.children?.props?.children[1]?.props?.children[0]?.props?.children?.props?.guildId)return;if(o){const f=t?.children?.props?.children?.props?.children[2]?.props?.children[0];if(f){const c=f.props.children[0].props.children;d.findInReactTree(c,function(m){return m.key=="DMTabsV2DMList-v2"})||c.push(n.createElement(U,{key:"DMTabsV2DMList-v2"},n.createElement(M,{userId:o})))}}}}}})),l.findByStoreName("PresenceStore"),A.push(p.patcher.after("default",l.findByName("ChannelHeader",!1),function(a,t){e.storage.dmTopBar&&t.type?.type?.name=="PrivateChannelHeader"&&p.patcher.after("type",t.type,function(o,f){if(!f.props?.children?.props?.children)return;const c=d.findInReactTree(f,function(y){return y.props?.user?.id})?.props?.user?.id;if(!c)return;const m=f.props?.children;if(!d.findInReactTree(f,function(y){return y.key=="DMTabsV2Header"})&&m.props?.children?.props?.children[1])if(typeof m.props?.children?.props?.children[1]?.type=="function"){const y=m.props?.children?.props?.children[1],T=p.patcher.after("type",y,function(ne,F){T(),d.findInReactTree(F,function(_){return _.key=="DMTabsV2Header-v2"})||F.props.children[0].props.children.push(n.createElement(U,{key:"DMTabsV2Header-v2"},n.createElement(M,{userId:c})))})}else{const y=w.getAssetIDByName("arrow-right");d.findInReactTree(m,function(T){return T.props?.children[1]?.props?.source==y}).props?.children?.push(n.createElement(D,{key:"DMTabsV2Header",style:{flexDirection:"row",justifyContent:"center",alignContent:"flex-start"}},n.createElement(D,{key:"DMTabsV2HeaderIcons",style:{flexDirection:"row"}})))}const L=d.findInReactTree(f,function(y){return y.key=="DMTabsV2HeaderIcons"});L&&(L.props.children=n.createElement(M,{userId:c}))})}));const u=l.findByName("DefaultName",!1);A.push(p.patcher.after("default",u,function(a,t){const o=a[0]?.user;o!==void 0&&t&&o.id&&e.storage.profileUsername&&t.props?.children[0]?.props?.children?.push(n.createElement(M,{userId:o.id}))}));const h=l.findByName("DisplayName",!1);A.push(p.patcher.after("default",h,function(a,t){const o=a[0]?.user;o!==void 0&&t&&o.id&&e.storage.profileUsername&&t.props?.children?.props?.children[0]?.props?.children?.push(n.createElement(M,{userId:o.id}))}));const s=l.findByName("Status",!1);A.push(p.patcher.before("default",s,function(a){a&&a[0]&&e.storage.removeDefaultMobile&&(a[0].isMobileOnline=!1)}));const g=l.findByProps("GuildMemberRow");g?.GuildMemberRow&&A.push(p.patcher.after("type",g.GuildMemberRow,function([{user:a}],t){!e.storage.userList||e.storage.oldUserListIcons||d.findInReactTree(t,function(o){return o.key=="GuildMemberRowStatusIconsView"})||d.findInReactTree(t,function(o){return o.props.style.flexDirection==="row"}).props.children.splice(2,0,n.createElement(D,{key:"GuildMemberRowStatusIconsView",style:{flexDirection:"row"}},n.createElement(M,{userId:a.id})))}));let k=!1;const X=function([{user:a}],t){e.storage.userList&&(d.findInReactTree(t?.props?.label,function(o){return o.key=="TabsV2MemberListStatusIconsView"})||(t.props.label=n.createElement(D,{style:{justifyContent:e.storage.oldUserListIcons?"space-between":"flex-start",flexDirection:"row",alignItems:"center"},key:"TabsV2MemberListStatusIconsView"},t.props.label,n.createElement(D,{key:"TabsV2MemberListStatusIconsView",style:{flexDirection:"row"}},n.createElement(M,{userId:a.id}))),k||(A.push(p.patcher.before("type",t.props.icon.type,function(o){e.storage.removeDefaultMobile&&(o[0].isMobileOnline=!1)})),k=!0)))};l.findByTypeNameAll("UserRow").forEach(function(a){return A.push(p.patcher.after("type",a,X))});const $=l.findByTypeName("MessagesItemChannelContent");A.push(p.patcher.after("type",$,function(a,t){const o=a[0]?.channel;if(o?.recipients?.length==1){const f=o.recipients[0];d.findInReactTree(t,function(c){return c.props.children[0].props.variant=="redesign/channel-title/semibold"}).props.children.push(n.createElement(D,{key:"TabsV2RedesignDMListIcons",style:{flexDirection:"row"}},n.createElement(M,{userId:f})))}}))},onUnload:function(){A.forEach(function(r){return r()})},settings:function(){return n.createElement(q,null)}};return I.default=W,Object.defineProperty(I,"__esModule",{value:!0}),I})({},vendetta,vendetta.metro,vendetta.ui.components,vendetta.utils,window.React,vendetta.metro.common,vendetta.ui.assets,vendetta.ui,vendetta.plugin,vendetta.storage);
