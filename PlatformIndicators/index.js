(function(B,u,l,w,f,r,i,E,I,e,V){"use strict";const{View:N,Text:ee,Image:K,Pressable:te}=i.ReactNative;l.findByName("Svg",!1).default,l.findByName("Svg",!1).Path,E.getAssetIDByName("ic_monitor_24px"),E.getAssetIDByName("ic_globe_24px"),E.getAssetIDByName("ic_mobile_device"),E.getAssetIDByName("ic_monitor_24px");const k={desktop:{url:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEgAAABICAMAAABiM0N1AAAAVFBMVEUAAACvv7+3u7+5u7+2ub+4u726vL65u765vL65vMG5u723ub23v7+3t7+6vL+4ur+6u765u764vL+4ur23t7+7vb+3ur25ur64ur+7u766ur6vr7/+1nXbAAAAHHRSTlMAEEB/UHDv/99fgIAgQJ+f7++fnyB/YN9vTz8QSaZf3QAAAI1JREFUeAHt1tUBwkAURNEXHZzg1n+d2Fc8u4OTOQXcyKqJ3ARh5C22qiQFYTC0khFIYyuYgDYthGagzQuhDLRFIYS7yBPuakLmSaF2CimkkEIKKfT8I5un0MdCT7v6LUFbFUIhaGsr2IAUWcl2B0K2t6pDVKttGR5P3BJvpxCnfdTMHVo9NaRQ1MpKRC5jHSw3VFQzIwAAAABJRU5ErkJggg==",path:"PlatformIndicators/Desktop.png"},web:{url:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEgAAABICAQAAAD/5HvMAAADgklEQVR42u3a32vVdRzH8VdOv2NzGzM7bkp0E9F9RQSbOmK6groQpeugOzXJfnCW3YwgC4IyHCldrBmFELtQRxfK2MHp1sjVZRfBMSJFYu6cMUnOOZPz9Gb45uyc79fv5/tDvDiPv+DJh/fn8+HL56umpqbHFZsZ4hjjzJOnQJkyBfLMM87H7GWzHh16OcoVKgQpM8N79Cht7GaSVcJa5QK7lBZe5SpRzDCgpLGdH6gS3SRPKzm8xTJxFTmgJNDKtyRllFbFQxfTRLVCvSk6FR3b+J3onuRTlllvgUzk1YmVsyJJdPMN1bqkzmizM00cc1rDIP9SawpPrjhFPAf1AN1cotZJ940ezwKb1q33BLX2Kzx2sBwzZ7vWoYXvAVOkV2FxlqjuMMtBNqkBNpIDzI/h7ywnTsfIP5gquxUGV3EiB7zMPcxlPRwDOJITTgNmpx6GyZSDnqKAOa9g9LKKIzniA0yFbQrC+5B6UDf/Y44oCFdwdUPOGMfkgr8kyrg6Lmf0YUq0yw9DuLnBcTw5YwNFzB754RhmkYaUCH7BDMsPZzDDZFMM+gQzJj/8inlTYiS1oNcws/LD35jnJUtKPOgFzHX5YQmzdmCRTSXoGcyi/FDGtEqWlHhQG6YULsjTA4zg5iZf4CkAXrig25gtUowk+FwB2IpZDDfUz8pEWiUF4DnM9XDbfkiKl6QAvB5u248H38KMJBZ0FDMW7uo4qwbIJhQ0gcnKD3sxN3lCirNKgZfrf5hB+aGdEuYVNUQ2dtAuTIk2+WMG87V8MBIzaBQzrdDDVqBDPuIE0cUy5rCC0MMq5lAqQR9hKmRcPoNu0ZF0EN0sYs7JBAyc+UwNsUJYd7nGO2zUGr4CTL9MqMGu8KIaYB43C2yVJPq4h8kpDAaoYv6kS3U4jKvfaGELeUyVfoXDT4C5wAatg8cfuHqbS4A54/K8UgTMd/WnNjuckyqAKdCj8DhArdO0NFilQ8xxhyiq7JMbRqk1GXAEuDshV3hMUesvXkoo6CKe3NHJArUqfEln7KBrdCgaMnVJcIsPa6OcczKKjk6mqFfkFH20RAi6SIfiweMkjS0xwTBvEFaVE3hKAvspEleBfUoOvTGfOH+mJ40X6ctEkaNfaWEn56kQVoVz9CltZDhCjhJBSuR4l4weHdrZwzBjzJFniTJlbpNnljGyDNLW/BmlqelxdR++AoGbDB4jjAAAAABJRU5ErkJggg==",path:"PlatformIndicators/Web.png"},mobile:{url:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGAAAABgCAMAAADVRocKAAAAXVBMVEUAAAAwMDgwMDUwMDUuMDYwMDYvMTcvMTYvMTYwMDYwMDUvMTYwMjUvMTUvMjYvMTUuMDUuMDQvMDUtMTUwMDgvMDUwMDAtMDYuMDYwMDAtMDUvMDYuMDUtMDcpMTo5aAq8AAAAH3RSTlMAIGBvf1C//89fMN9g75+/j3+fP0C/IFBfMGDPb08fcZ9WCgAAAMNJREFUeAHt2YWNxQAMg2EX/fiVud1/zBuhSaRjfwv8UsQx5J9L0iw/VySIyUoaXa7wu93pcE/g9KDTFS4F+amF5Em3ZwK7FwPeMEsYcoNVxZAaViX5uTd6MuQJKwY5A01u9goFWph1fyKggAIKKKCAAgoooIACCiiggAIKKKCAAgoooIACn/l9d/t3gU/fcEqG9LDKGVLB6saQAZ97owZ2w5NuzwEOKd1G4FMLE5wG36Y/w29ZadRviBn2/Nw2HfjTPgD3/UVA1TCAGgAAAABJRU5ErkJggg==",path:"PlatformIndicators/Mobile.png"},embedded:{url:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEgAAABICAMAAABiM0N1AAAAk1BMVEUAAAC3u7+4ur+5vL+5u765u7+6vL+2ub+3v7+6u7+5vL66v7+6vL65u761ur+4u765vL+3t7+6u765u7+9vb23t7+7vb+6u766ur+5ur6/v7+vv7+9vcW1tb+5u727u763ur25vL+6vL+3ub24ur+5u7+4vL+5ur66ur64ur25vL+6u764ur24u722uby5u76vr7/eehxsAAAAMXRSTlMAQJ/f/8+fUCC/3zDv7zC/UEDvfx8gf88w3xAQHzCAT2Bfb4Bvj5/PP6+vv59wUM8QEONx+AAAAWZJREFUeAHt1dWa6zAMBOA5PSqzs2Vmhvd/uWWcVFHqr5f+r+3JRqtJ8UhBEAT/Mv8lpWwuD02hKHcpFXBTuSJ3qtZwQ0HPUVULiCuJhzpiGuKlCZaTL3gnxEVPaLWdkAxYJznIdfGmy0k9MEkOivChLQSkbwS18KElZEBBLSMIX4QMuRxaEJ0vCBndCkJMbEZjIRO6MTWCqjWlRjO6MTeCpLoooDWuCFvSjcgK0pYzohsrM0hZzhXdWJtBynJyR4rGv19dzrp3EC3nhoJKZpCynNxalzqIlrPKU7WDlOXUym8H0XIOufy+htxZX9tHBU24/L5mXH5fSy6/r4jL/8sOidYJv2x7fu0k84SgIn/Qmb50dT2oB6YXk+tf4hElWuuPdeaIlCFx/fkLeM+Q1Ferw3RQZ9SmP8jQlR9H/NZ3tKmG08+sW/SMnrxzZ6Qy/TrfBWkdL+Lq0RUptaYHJyU+HwRB4O0FjTMnvIkvoBQAAAAASUVORK5CYII=",path:"PlatformIndicators/Console.png"}};function P(t){const{platform:c,color:d}=t,n=t.iconSize??16;return React.createElement(N,null,React.createElement(K,{style:{height:n,width:n,tintColor:d},source:{uri:k[c].url,width:n,height:n,path:k[c].path,allowIconTheming:!0}}))}const J={online:i.chroma(I.rawColors.GREEN_360).hex(),dnd:i.chroma(I.rawColors.RED_400).hex(),idle:i.chroma(I.rawColors.YELLOW_300).hex(),offline:i.chroma(I.rawColors.PRIMARY_400).hex()},z={online:"#23a55a",dnd:"#f23f43",idle:"#f0b232",offline:"#80848e"};function x(t,c=!1){return c?z[t]:J[t]}const G=l.findByStoreName("PresenceStore"),H=l.findByStoreName("SessionsStore"),Q=l.findByStoreName("UserStore");let C,R=0,T,S;function Y(){return T||(T=setTimeout(function(){R=0,T=null},5e3)),(!C||R==0)&&(C=G.getState()),R=(R+1)%20,C}function O(t){let c;return S||(S=Q.getCurrentUser()?.id),t==S?c=Object.values(H.getSessions()).reduce(function(d,n){return n.clientInfo.client!=="unknown"&&(d[n.clientInfo.client]=n.status),d},{}):c=Y()?.clientStatuses[t],c}function y(t){V.useProxy(e.storage);const c=t.userId,d=t.size??16,n=O(c);return r.createElement(r.Fragment,null,Object.keys(n??{}).map(function(M){return r.createElement(P,{platform:M,color:x(n[M],e.storage.fallbackColors),iconSize:d})}))}const{View:j,ScrollView:Z}=i.ReactNative;function q(){return V.useProxy(e.storage),i.React.createElement(Z,null,i.React.createElement(j,null,i.React.createElement(w.Forms.FormSwitchRow,{label:"Show icons on the dm top bar",value:e.storage.dmTopBar??!0,onValueChange:function(t){return e.storage.dmTopBar=t},note:""}),i.React.createElement(w.Forms.FormSwitchRow,{label:"Show icons on the users and DMs list",value:e.storage.userList??!0,onValueChange:function(t){return e.storage.userList=t},note:""}),i.React.createElement(w.Forms.FormSwitchRow,{label:"Show icons on user profiles",value:e.storage.profileUsername??!0,onValueChange:function(t){return e.storage.profileUsername=t},note:""}),i.React.createElement(w.Forms.FormSwitchRow,{label:"Hide mobile status from the normal indicator",value:e.storage.removeDefaultMobile??!0,onValueChange:function(t){return e.storage.removeDefaultMobile=t},note:""}),i.React.createElement(w.Forms.FormSwitchRow,{label:"Theme compatibility mode",value:e.storage.fallbackColors??!1,onValueChange:function(t){return e.storage.fallbackColors=t},note:""}),i.React.createElement(w.Forms.FormSwitchRow,{label:"Old user list icon style",value:e.storage.oldUserListIcons??!1,onValueChange:function(t){return e.storage.oldUserListIcons=t},note:"Moves status indicators to the right"})))}const F=function({children:t}){const[c,d]=r.useState(0);return r.useEffect(function(){const n=function(){d(function(M){return M+1})};return i.FluxDispatcher.subscribe("PRESENCE_UPDATES",n),function(){i.FluxDispatcher.unsubscribe("PRESENCE_UPDATES",n)}},[]),r.Children.map(t,function(n,M){return r.cloneElement(n,{key:`${M}-${c}`})})},{Text:re,View:D}=w.General;let h=[];var W={onLoad:function(){e.storage.dmTopBar??=!0,e.storage.userList??=!0,e.storage.profileUsername??=!0,e.storage.removeDefaultMobile??=!0,e.storage.fallbackColors??=!1,e.storage.oldUserListIcons??=!1,l.findByStoreName("PresenceStore"),h.push(u.patcher.after("default",l.findByName("ChannelHeader",!1),function(a,o){e.storage.dmTopBar&&o.type?.type?.name=="PrivateChannelHeader"&&u.patcher.after("type",o.type,function(s,p){if(!p.props?.children?.props?.children)return;const g=f.findInReactTree(p,function(A){return A.props?.user?.id})?.props?.user?.id;if(!g)return;const b=p.props?.children;if(!f.findInReactTree(p,function(A){return A.key=="DMTabsV2Header"})&&b.props?.children?.props?.children[1])if(typeof b.props?.children?.props?.children[1]?.type=="function"){const A=b.props?.children?.props?.children[1],m=u.patcher.after("type",A,function(L,v){m(),f.findInReactTree(v,function(_){return _.key=="DMTabsV2Header-v2"})||v.props.children[0].props.children.push(r.createElement(F,{key:"DMTabsV2Header-v2"},r.createElement(y,{userId:g})))})}else{const A=E.getAssetIDByName("arrow-right");f.findInReactTree(b,function(m){return m.props?.children[1]?.props?.source==A}).props?.children?.push(r.createElement(D,{key:"DMTabsV2Header",style:{flexDirection:"row",justifyContent:"center",alignContent:"flex-start"}},r.createElement(D,{key:"DMTabsV2HeaderIcons",style:{flexDirection:"row"}})))}const U=f.findInReactTree(p,function(A){return A.key=="DMTabsV2HeaderIcons"});U&&(U.props.children=r.createElement(y,{userId:g}))})}));const t=l.findByTypeName("UserProfileContent");h.push(u.patcher.after("type",t,function(a,o){let s=f.findInReactTree(o,function(p){return p?.type?.name=="PrimaryInfo"});u.patcher.after("type",s,function(p,g){g?.type?.name=="UserProfilePrimaryInfo"&&u.patcher.after("type",g,function(b,U){let A=f.findInReactTree(U,function(m){return m?.type?.name=="DisplayName"});u.patcher.after("type",A,function(m,L){let v=m[0]?.user?.id;v&&L.props.children.push(r.createElement(F,{key:"UserProfileIcons"},r.createElement(y,{userId:v})))})})})}));const c=l.findByProps("DisplayName");h.push(u.patcher.after("DisplayName",c,function(a,o){console.log("DISPLAYNAME",a,o),window.dn1=a,window.dn2=o;const s=a[0]?.user;s!==void 0&&o&&s.id&&e.storage.profileUsername&&o.props?.children?.props?.children[0]?.props?.children?.push(r.createElement(y,{userId:s.id}))}));const d=l.findByName("Status",!1);h.push(u.patcher.before("default",d,function(a){a&&a[0]&&e.storage.removeDefaultMobile&&(a[0].isMobileOnline=!1)}));const n=l.findByProps("GuildMemberRow");n?.GuildMemberRow&&h.push(u.patcher.after("type",n.GuildMemberRow,function([{user:a}],o){!e.storage.userList||e.storage.oldUserListIcons||f.findInReactTree(o,function(s){return s.key=="GuildMemberRowStatusIconsView"})||f.findInReactTree(o,function(s){return s.props.style.flexDirection==="row"}).props.children.splice(2,0,r.createElement(D,{key:"GuildMemberRowStatusIconsView",style:{flexDirection:"row"}},r.createElement(y,{userId:a.id})))}));let M=!1;const X=function([{user:a}],o){e.storage.userList&&(f.findInReactTree(o?.props?.label,function(s){return s.key=="TabsV2MemberListStatusIconsView"})||(o.props.label=r.createElement(D,{style:{justifyContent:e.storage.oldUserListIcons?"space-between":"flex-start",flexDirection:"row",alignItems:"center"},key:"TabsV2MemberListStatusIconsView"},o.props.label,r.createElement(D,{key:"TabsV2MemberListStatusIconsView",style:{flexDirection:"row"}},r.createElement(y,{userId:a.id}))),M||(h.push(u.patcher.before("type",o.props.icon.type,function(s){e.storage.removeDefaultMobile&&(s[0].isMobileOnline=!1)})),M=!0)))};l.findByTypeNameAll("UserRow").forEach(function(a){return h.push(u.patcher.after("type",a,X))});const $=l.findByTypeName("MessagesItemChannelContent");h.push(u.patcher.after("type",$,function(a,o){const s=a[0]?.channel;if(s?.recipients?.length==1){const p=s.recipients[0];f.findInReactTree(o,function(g){return g.props.children[0].props.variant=="redesign/channel-title/semibold"}).props.children.push(r.createElement(D,{key:"TabsV2RedesignDMListIcons",style:{flexDirection:"row"}},r.createElement(y,{userId:p})))}}))},onUnload:function(){h.forEach(function(t){return t()})},settings:function(){return r.createElement(q,null)}};return B.default=W,Object.defineProperty(B,"__esModule",{value:!0}),B})({},vendetta,vendetta.metro,vendetta.ui.components,vendetta.utils,window.React,vendetta.metro.common,vendetta.ui.assets,vendetta.ui,vendetta.plugin,vendetta.storage);
